<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEC-WAM | SOVEREIGN INTERFACE</title>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <style>
        :root {
            --neon-blue: #00f3ff;
            --neon-green: #00ff00;
            --neon-gold: #ffd700;
            --glass-bg: rgba(10, 20, 30, 0.90);
            --border-color: rgba(0, 243, 255, 0.3);
            --bg-color: #050505;
        }
        body {
            background-color: var(--bg-color);
            color: var(--neon-blue);
            font-family: 'Courier New', monospace;
            margin: 0;
            padding: 20px;
            background-image: radial-gradient(circle at 50% 50%, #111 0%, #000 100%);
            min-height: 100vh;
        }
        .header-container {
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 20px;
        }
        .header-icon {
            width: 80px;
            filter: drop-shadow(0 0 10px var(--neon-blue));
            margin-bottom: 10px;
        }
        h1 { 
            text-shadow: 0 0 15px var(--neon-blue); 
            margin: 0; 
            color: var(--neon-gold);
            letter-spacing: 2px;
        }
        .status-bar {
            text-align: center;
            font-size: 14px;
            color: #888;
            margin-bottom: 30px;
        }
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .metric-card {
            background: var(--glass-bg);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.1);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        .metric-card:hover { 
            transform: translateY(-5px); 
            border-color: var(--neon-green); 
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.2);
        }
        .metric-label { 
            font-size: 16px; 
            letter-spacing: 2px; 
            color: #aaa; 
            margin-bottom: 15px; 
            text-transform: uppercase;
        }
        .metric-value { 
            font-size: 36px; 
            font-weight: bold; 
            color: #fff; 
            text-shadow: 0 0 15px var(--neon-blue);
            margin: 10px 0; 
        }
        .metric-sub { font-size: 12px; color: var(--neon-green); text-transform: uppercase; font-weight: bold; }
        .metric-sub.warn { color: #ffcc00; }
        .metric-sub.lock { color: #ff0055; }
        
        .loading { color: #ffcc00; font-weight: bold; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0.5; } }
        
        /* Footer Console */
        .console-log {
            margin-top: 50px;
            background: #000;
            border: 1px solid #333;
            padding: 15px;
            font-size: 12px;
            color: #0f0;
            height: 100px;
            overflow-y: auto;
            font-family: monospace;
            max-width: 800px;
            margin-left: auto; 
            margin-right: auto;
        }
    </style>
</head>
<body>

    <div class="header-container">
        <img src="https://img.icons8.com/color/96/000000/artificial-intelligence.png" class="header-icon" alt="System Core">
        <h1>ðŸ¦… CEC-WAM: LIVE CORE</h1>
    </div>

    <div class="status-bar">
        SYSTEM STATUS: <span style="color:#0f0">ONLINE</span> | 
        DATA SOURCE: <span id="conn-status" class="loading">CONNECTING TO LEDGER...</span> | 
        MODE: <span style="color:var(--neon-gold)">GOD_MODE</span>
    </div>

    <div class="grid-container">
        <div class="metric-card">
            <div class="metric-label">LIQUID VALUATION</div>
            <div class="metric-value" id="val-liquidity" style="color: #00ff00;">$0.00</div>
            <div class="metric-sub">VERIFIED ASSETS (10X LOCKED)</div>
        </div>

        <div class="metric-card">
            <div class="metric-label">TOTAL MASS (PSI)</div>
            <div class="metric-value" id="val-mass">0.00</div>
            <div class="metric-sub">EXPANSION CONFIRMED</div>
        </div>

        <div class="metric-card">
            <div class="metric-label">NET WORTH</div>
            <div class="metric-value" id="val-networth">LOCKED</div>
            <div class="metric-sub lock">QUANTUM IP VALUE</div>
        </div>

        <div class="metric-card">
            <div class="metric-label">ESCROW BRIDGE</div>
            <div class="metric-value" id="val-escrow">---</div>
            <div class="metric-sub warn" id="sub-escrow">SYNCING...</div>
        </div>

        <div class="metric-card">
            <div class="metric-label">GUNLOCK PROTOCOL</div>
            <div class="metric-value" id="val-gunlock">PENDING</div>
            <div class="metric-sub warn">SECURITY CHECK</div>
        </div>
        
         <div class="metric-card">
            <div class="metric-label">EARTH SHIELD</div>
            <div class="metric-value" id="val-shield">---</div>
            <div class="metric-sub" style="color:#00ff00">ENTROPIC CLOAK</div>
        </div>
    </div>
    
    <div class="console-log" id="sys-log">
        > SYSTEM INITIALIZED...<br>
        > WAITING FOR LEDGER DATA...
    </div>

<script>
    // --- CONFIGURATION ---
    const FILE_URL = "CEC_WAM_MASTER_LEDGER_LIVE.xlsx"; // Must match your file name exactly

    // --- LOGGING HELPER ---
    function log(msg) {
        const consoleDiv = document.getElementById("sys-log");
        const time = new Date().toLocaleTimeString();
        consoleDiv.innerHTML += `> [${time}] ${msg}<br>`;
        consoleDiv.scrollTop = consoleDiv.scrollHeight;
    }

    // --- MAIN DATA LOADER ---
    async function loadLiveLedger() {
        try {
            log("Fetching CEC_WAM_MASTER_LEDGER_LIVE.xlsx...");
            const response = await fetch(FILE_URL);
            
            if (!response.ok) {
                throw new Error("Ledger file not found. Ensure file is in Repo.");
            }
            
            const arrayBuffer = await response.arrayBuffer();
            const workbook = XLSX.read(arrayBuffer);
            const sheetName = workbook.SheetNames[0]; 
            const jsonData = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName]);

            log(`Data Loaded: ${jsonData.length} Rows Detected.`);
            
            // --- DATA PARSING LOGIC ---
            // Helper to find value by Metric Name
            function getMetric(name) {
                // Tries to find the row where "Metric Name" or "Metric" matches
                return jsonData.find(r => 
                    (r["Metric Name"] && r["Metric Name"].trim() === name) || 
                    (r["Metric"] && r["Metric"].trim() === name)
                );
            }

            // 1. LIQUIDITY (Targeting "Total Liquidity")
            const liquidityRow = getMetric("Total Liquidity");
            if (liquidityRow) {
                // PRIORITY: Live Value (Real) -> Value (Raw)
                const val = liquidityRow["Live Value (Real)"] || liquidityRow["Value (Raw)"];
                document.getElementById("val-liquidity").innerText = val;
                log(`LIQUIDITY UPDATED: ${val}`);
            }

            // 2. TOTAL MASS
            const massRow = getMetric("Total Mass");
            if (massRow) {
                const val = massRow["Live Value (Real)"] || massRow["Value (Raw)"];
                document.getElementById("val-mass").innerText = val;
            }

            // 3. NET WORTH
            const netRow = getMetric("Net Worth");
            if (netRow) {
                const val = netRow["Live Value (Real)"] || netRow["Value (Raw)"];
                document.getElementById("val-networth").innerText = val;
            }

            // 4. ESCROW
            const escrowRow = getMetric("Escrow Status");
            if (escrowRow) {
                document.getElementById("val-escrow").innerText = escrowRow["Value (Raw)"] || "84%";
                document.getElementById("sub-escrow").innerText = escrowRow["Status"] || "PENDING";
            }

            // 5. GUNLOCK
            const gunlockRow = getMetric("Gunlock Sync");
            if (gunlockRow) {
                const status = gunlockRow["Status"] || "PENDING";
                document.getElementById("val-gunlock").innerText = status;
                document.getElementById("val-gunlock").style.color = (status === "ACTIVE") ? "#00ff00" : "#ffcc00";
            }
            
            // 6. EARTH SHIELD
            const shieldRow = getMetric("Earth Shield");
            if (shieldRow) {
                document.getElementById("val-shield").innerText = shieldRow["Value (Raw)"] || "100%";
            }

            // Success State
            document.getElementById("conn-status").innerText = "LINKED: LIVE EXCEL";
            document.getElementById("conn-status").className = "";
            document.getElementById("conn-status").style.color = "#00ff00";
            log("ALL SYSTEMS SYNCED. 10X DATA LOCKED.");

        } catch (error) {
            console.error(error);
            document.getElementById("conn-status").innerText = "LINK ERROR";
            document.getElementById("conn-status").style.color = "red";
            log(`ERROR: ${error.message}`);
        }
    }

    // Run immediately
    loadLiveLedger();
</script>

</body>
</html>
