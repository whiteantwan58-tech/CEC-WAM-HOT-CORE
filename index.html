<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CEC-WAM | LIVE MATRIX</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
  <style>
    body { background-color: #050505; color: #00f3ff; font-family: 'Courier New', monospace; overflow: hidden; }
    .glass { background: rgba(10, 20, 30, 0.85); backdrop-filter: blur(10px); border: 1px solid rgba(0, 243, 255, 0.3); border-radius: 12px; }
    .neon-text { color: #bc13fe; text-shadow: 0 0 10px #bc13fe; }
    .neon-green { color: #00ff00; text-shadow: 0 0 10px #00ff00; }
    canvas#matrix { position: fixed; top: 0; left: 0; z-index: -1; opacity: 0.15; }
  </style>
</head>
<body class="p-4 flex flex-col h-screen">

<canvas id="matrix"></canvas>

<header class="glass p-4 mb-4 flex justify-between items-center z-10">
  <div>
    <h1 class="text-2xl font-bold">CEC-WAM <span class="neon-text">LIVE CORE</span></h1>
    <p class="text-xs text-gray-400">DATA SOURCE: <span id="source-name" class="text-yellow-500">CONNECTING...</span></p>
  </div>
  <div class="text-right">
    <p id="live-psi" class="text-xl font-bold neon-green">PSI: ---</p>
    <p id="live-cash" class="text-sm text-gray-300">ESCROW: ---</p>
  </div>
</header>

<main class="glass flex-1 overflow-y-auto p-4 z-10 flex flex-col">
  <div id="chat-log" class="flex-1 space-y-2 text-sm pb-4">
    <div class="text-green-400">> SYSTEM: INITIALIZING LINK...</div>
  </div>
  <div class="mt-2 flex gap-2 border-t border-gray-700 pt-2">
    <input id="user-input" type="text" class="flex-1 bg-black border border-cyan-500 rounded p-2 text-white" placeholder="Enter command...">
    <button onclick="talkToEve()" class="bg-cyan-600 text-white px-4 py-2 rounded">SEND</button>
  </div>
</main>

<script>
  // ðŸ”´ PASTE YOUR GOOGLE PUBLISH LINK INSIDE THESE QUOTES BELOW ðŸ”´
  const LIVE_SHEET_URL = "PASTE_YOUR_PUBLISHED_CSV_LINK_HERE"; 

  // --- 1. LIVE DATA SYNC ---
  async function fetchLiveData() {
    if (LIVE_SHEET_URL.includes("PASTE_YOUR")) {
        document.getElementById('source-name').innerText = "WAITING FOR LINK";
        return; 
    }
    
    Papa.parse(LIVE_SHEET_URL, {
      download: true,
      header: true, // Assumes Row 1 is headers (ASSET CLASS, VALUE)
      complete: function(results) {
        const data = results.data;
        console.log("Sheet Data:", data);
        
        // FIND YOUR METRICS (Based on your Screen)
        // We look in the 'A (ASSET CLASS)' column for names
        // We look in the 'D (VALUE)' column for numbers
        
        let psiValue = "0.00";
        let escrowValue = "$0.00";

        // Loop through rows to find matches
        data.forEach(row => {
            // Adjust these keys if your CSV headers are different
            // Google Sheets CSV usually uses the exact header text
            const assetName = row['A (ASSET CLASS)'] || row['A'] || row['Asset']; 
            const val = row['D (VALUE)'] || row['D'] || row['Value'];

            if (assetName && assetName.includes("Psi-Coins")) {
                psiValue = val;
            }
            if (assetName && assetName.includes("Escrow Bridge")) {
                escrowValue = val;
            }
        });

        document.getElementById('live-psi').innerText = `PSI: ${psiValue}`;
        document.getElementById('live-cash').innerText = `ESCROW: ${escrowValue}`;
        document.getElementById('source-name').innerText = "GOOGLE SHEET LIVE";
        document.getElementById('source-name').className = "neon-green";
      }
    });
  }

  // --- 2. MATRIX VISUALS ---
  const canvas = document.getElementById('matrix');
  const ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth; canvas.height = window.innerHeight;
  const chars = 'CEC-WAM-1010'.split('');
  const drops = Array(Math.floor(canvas.width / 20)).fill(1);
  setInterval(() => {
    ctx.fillStyle = 'rgba(0, 0, 0, 0.05)'; ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = '#bc13fe';
    drops.forEach((y, i) => {
      ctx.fillText(chars[Math.floor(Math.random()*chars.length)], i*20, y*20);
      if (y*20 > canvas.height && Math.random() > 0.975) drops[i] = 0;
      drops[i]++;
    });
  }, 50);

  // --- 3. INIT ---
  setInterval(fetchLiveData, 3000); // Check every 3 seconds
  fetchLiveData();

  // Chat Placeholder
  function talkToEve() {
      const log = document.getElementById('chat-log');
      log.innerHTML += `<div class="text-red-500">> SYSTEM: AI BRAIN OFFLINE. (Add Groq Key to enable)</div>`;
  }
</script>
</body>
</html>
